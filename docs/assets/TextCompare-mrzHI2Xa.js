import{d as e,r as l,c as a,a as t,o as s,b as n,e as i,f as o,w as r,t as u,v as c,q as v,n as d,F as p,h,_ as m}from"./main-BuE8beIh.js";const f={class:"text-compare"},y={class:"compare-header"},g={class:"compare-content"},b={class:"compare-section"},x={class:"compare-container"},k={class:"text-panel"},w={class:"panel-header"},C={class:"panel-actions"},M={key:0,class:"file-info"},B={class:"file-name"},L={class:"file-size"},N={class:"text-stats"},H={class:"text-panel"},A={class:"panel-header"},T={class:"panel-actions"},z={key:0,class:"file-info"},V={class:"file-name"},j={class:"file-size"},_={class:"text-stats"},F={class:"compare-options"},U={class:"option-group"},I={class:"checkbox-label"},$={class:"checkbox-label"},W={class:"checkbox-label"},E=["disabled"],q={key:0,class:"compare-section"},G={class:"result-container"},K={class:"result-summary"},P={class:"summary-item"},R={class:"summary-item"},D={class:"summary-value"},J={class:"summary-item"},O={class:"summary-value added"},Q={class:"summary-item"},S={class:"summary-value removed"},X={class:"diff-view"},Y={class:"diff-header"},Z={class:"view-options"},ee={key:0,class:"diff-content unified"},le={class:"line-number"},ae={class:"line-prefix"},te=["innerHTML"],se={key:1,class:"diff-content split"},ne={class:"split-body"},ie={class:"line-number"},oe=["innerHTML"],re={key:1,class:"line-content empty"},ue={class:"line-number"},ce=["innerHTML"],ve={key:1,class:"line-content empty"},de=m(e({__name:"TextCompare",emits:["back"],setup(e){const m=l(""),de=l(""),pe=l(),he=l(),me=l(null),fe=l(null),ye=l("split"),ge=l({ignoreCase:!1,ignoreWhitespace:!1,ignoreLineBreaks:!1}),be=l(null),xe=l(""),ke=l("success"),we=async(e,l)=>{const a=e.target,t=a.files?.[0];if(t)if(t.size>10485760)Ue("文件大小不能超过10MB","error");else try{const e=await Ce(t);"A"===l?(m.value=e,me.value={name:t.name,size:t.size}):(de.value=e,fe.value={name:t.name,size:t.size}),ze(),Ue(`文件 ${t.name} 上传成功`,"success")}catch(s){Ue("文件读取失败","error")}},Ce=e=>new Promise((l,a)=>{const t=new FileReader;t.onload=e=>{const t=e.target?.result;"string"==typeof t?l(t):a(new Error("文件读取失败"))},t.onerror=a,t.readAsText(e,"UTF-8")}),Me=async e=>{try{const l=await navigator.clipboard.readText();"A"===e?(m.value=l,me.value=null):(de.value=l,fe.value=null),ze(),Ue("文本已粘贴","success")}catch(l){Ue("粘贴失败","error")}},Be=e=>{"A"===e?(m.value="",me.value=null,pe.value&&(pe.value.value="")):(de.value="",fe.value=null,he.value&&(he.value.value="")),ze(),Ue(`文本${e}已清空`,"success")},Le=()=>{m.value="",de.value="",me.value=null,fe.value=null,be.value=null,pe.value&&(pe.value.value=""),he.value&&(he.value.value=""),Ue("已清空所有内容","success")},Ne=e=>e?e.split("\n").length:0,He=e=>{if(0===e)return"0 B";const l=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,l)).toFixed(2))+" "+["B","KB","MB","GB"][l]},Ae=e=>{let l=e;return ge.value.ignoreCase&&(l=l.toLowerCase()),ge.value.ignoreWhitespace&&(l=l.replace(/\s+/g," ").trim()),ge.value.ignoreLineBreaks&&(l=l.replace(/\n/g," ")),l},Te=(e,l)=>{const a=e.length,t=l.length,s=Array(t+1).fill(null).map(()=>Array(a+1).fill(0));for(let n=0;n<=a;n++)s[0][n]=n;for(let n=0;n<=t;n++)s[n][0]=n;for(let n=1;n<=t;n++)for(let t=1;t<=a;t++)l[n-1]===e[t-1]?s[n][t]=s[n-1][t-1]:s[n][t]=Math.min(s[n-1][t]+1,s[n][t-1]+1,s[n-1][t-1]+1);return s[t][a]},ze=()=>{if(!m.value&&!de.value)return void(be.value=null);if(!m.value||!de.value)return void(be.value=null);const e=Ae(m.value),l=Ae(de.value),a=e.split("\n"),t=l.split("\n"),s=((e,l)=>{if(e===l)return 100;if(!e||!l)return 0;const a=e.length>l.length?e:l,t=e.length>l.length?l:e;if(0===a.length)return 100;const s=Te(a,t);return(a.length-s)/a.length*100})(e,l),n=Ve(a,t);let i=0,o=0,r=0;n.forEach(e=>{"added"===e.type?i++:"removed"===e.type?o++:"modified"===e.type&&r++}),be.value={similarity:s,diffLines:r,addedLines:i,removedLines:o,diffs:n}},Ve=(e,l)=>{const a=[],t=Math.max(e.length,l.length);for(let s=0;s<t;s++){const t=e[s],n=l[s];void 0===t&&void 0!==n?a.push({type:"added",lineNumber:s+1,prefix:"+",content:n}):void 0===n&&void 0!==t?a.push({type:"removed",lineNumber:s+1,prefix:"-",content:t}):void 0!==t&&void 0!==n&&t!==n?(a.push({type:"removed",lineNumber:s+1,prefix:"-",content:t}),a.push({type:"added",lineNumber:s+1,prefix:"+",content:n})):void 0!==t&&void 0!==n&&t===n&&a.push({type:"unchanged",lineNumber:s+1,prefix:" ",content:t})}return a.filter(e=>"unchanged"!==e.type)},je=a(()=>{if(!be.value)return[];const e=[],l=m.value.split("\n"),a=de.value.split("\n"),t=Math.max(l.length,a.length);for(let s=0;s<t;s++){const t=l[s],n=a[s];void 0===t&&void 0!==n?e.push({left:void 0,right:{type:"added",lineNumber:s+1,content:n}}):void 0===n&&void 0!==t?e.push({left:{type:"removed",lineNumber:s+1,content:t},right:void 0}):void 0!==t&&void 0!==n&&(t===n?e.push({left:{type:"unchanged",lineNumber:s+1,content:t},right:{type:"unchanged",lineNumber:s+1,content:n}}):e.push({left:{type:"removed",lineNumber:s+1,content:t},right:{type:"added",lineNumber:s+1,content:n}}))}return e}),_e=(e,l)=>"unchanged"===l?e:`<span class="highlight-${l}">${Fe(e)}</span>`,Fe=e=>{const l=document.createElement("div");return l.textContent=e,l.innerHTML},Ue=(e,l)=>{xe.value=e,ke.value=l,setTimeout(()=>{xe.value=""},3e3)};return(e,l)=>{return s(),t("div",f,[n("div",y,[n("button",{class:"back-btn",onClick:l[0]||(l[0]=l=>e.$emit("back"))},[...l[16]||(l[16]=[n("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[n("path",{d:"m15 18-6-6 6-6"})],-1),o(" 返回 ",-1)])]),l[18]||(l[18]=n("h2",{class:"compare-title"},"文本比对",-1)),n("div",{class:"compare-actions"},[n("button",{class:"action-btn",onClick:Le,title:"清空所有"},[...l[17]||(l[17]=[n("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[n("path",{d:"M3 6h18"}),n("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),n("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"})],-1)])])])]),n("div",g,[n("div",b,[l[31]||(l[31]=n("div",{class:"section-header"},[n("h3",null,"文本比对"),n("div",{class:"section-info"},[n("span",{class:"info-text"},"比较两个文本的差异，支持文件上传")])],-1)),n("div",x,[n("div",k,[n("div",w,[l[22]||(l[22]=n("h4",null,"文本A",-1)),n("div",C,[n("input",{ref_key:"fileInputA",ref:pe,type:"file",onChange:l[1]||(l[1]=e=>we(e,"A")),accept:".txt,.md,.json,.xml,.html,.css,.js,.ts,.vue,.py,.java,.cpp,.c,.h",style:{display:"none"}},null,544),n("button",{class:"upload-btn",onClick:l[2]||(l[2]=e=>pe.value?.click()),title:"上传文件"},[...l[19]||(l[19]=[n("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[n("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),n("polyline",{points:"17,8 12,3 7,8"}),n("line",{x1:"12",y1:"3",x2:"12",y2:"15"})],-1)])]),n("button",{class:"paste-btn",onClick:l[3]||(l[3]=e=>Me("A")),title:"粘贴"},[...l[20]||(l[20]=[n("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[n("rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1"}),n("path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"})],-1)])]),n("button",{class:"clear-btn",onClick:l[4]||(l[4]=e=>Be("A")),title:"清空"},[...l[21]||(l[21]=[n("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[n("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),n("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])])])]),me.value?(s(),t("div",M,[n("span",B,u(me.value.name),1),n("span",L,u(He(me.value.size)),1)])):i("",!0),r(n("textarea",{"onUpdate:modelValue":l[5]||(l[5]=e=>m.value=e),placeholder:"请输入或上传第一个文本...",class:"text-input",onInput:ze},null,544),[[c,m.value]]),n("div",N,[n("span",null,"字符数: "+u(m.value.length),1),n("span",null,"行数: "+u(Ne(m.value)),1)])]),n("div",H,[n("div",A,[l[26]||(l[26]=n("h4",null,"文本B",-1)),n("div",T,[n("input",{ref_key:"fileInputB",ref:he,type:"file",onChange:l[6]||(l[6]=e=>we(e,"B")),accept:".txt,.md,.json,.xml,.html,.css,.js,.ts,.vue,.py,.java,.cpp,.c,.h",style:{display:"none"}},null,544),n("button",{class:"upload-btn",onClick:l[7]||(l[7]=e=>he.value?.click()),title:"上传文件"},[...l[23]||(l[23]=[n("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[n("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),n("polyline",{points:"17,8 12,3 7,8"}),n("line",{x1:"12",y1:"3",x2:"12",y2:"15"})],-1)])]),n("button",{class:"paste-btn",onClick:l[8]||(l[8]=e=>Me("B")),title:"粘贴"},[...l[24]||(l[24]=[n("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[n("rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1"}),n("path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"})],-1)])]),n("button",{class:"clear-btn",onClick:l[9]||(l[9]=e=>Be("B")),title:"清空"},[...l[25]||(l[25]=[n("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[n("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),n("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])])])]),fe.value?(s(),t("div",z,[n("span",V,u(fe.value.name),1),n("span",j,u(He(fe.value.size)),1)])):i("",!0),r(n("textarea",{"onUpdate:modelValue":l[10]||(l[10]=e=>de.value=e),placeholder:"请输入或上传第二个文本...",class:"text-input",onInput:ze},null,544),[[c,de.value]]),n("div",_,[n("span",null,"字符数: "+u(de.value.length),1),n("span",null,"行数: "+u(Ne(de.value)),1)])])]),n("div",F,[n("div",U,[n("label",I,[r(n("input",{"onUpdate:modelValue":l[11]||(l[11]=e=>ge.value.ignoreCase=e),type:"checkbox",onChange:ze},null,544),[[v,ge.value.ignoreCase]]),l[27]||(l[27]=n("span",null,"忽略大小写",-1))]),n("label",$,[r(n("input",{"onUpdate:modelValue":l[12]||(l[12]=e=>ge.value.ignoreWhitespace=e),type:"checkbox",onChange:ze},null,544),[[v,ge.value.ignoreWhitespace]]),l[28]||(l[28]=n("span",null,"忽略空白字符",-1))]),n("label",W,[r(n("input",{"onUpdate:modelValue":l[13]||(l[13]=e=>ge.value.ignoreLineBreaks=e),type:"checkbox",onChange:ze},null,544),[[v,ge.value.ignoreLineBreaks]]),l[29]||(l[29]=n("span",null,"忽略换行符",-1))])]),n("button",{class:"compare-btn",onClick:ze,disabled:!m.value||!de.value},[...l[30]||(l[30]=[n("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[n("path",{d:"M9 11H5a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h4"}),n("path",{d:"M15 11h4a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2h-4"}),n("path",{d:"M12 2v20"})],-1),o(" 开始比对 ",-1)])],8,E)])]),be.value?(s(),t("div",q,[l[39]||(l[39]=n("div",{class:"section-header"},[n("h3",null,"比对结果"),n("div",{class:"section-info"},[n("span",{class:"info-text"},"文本差异分析结果")])],-1)),n("div",G,[n("div",K,[n("div",P,[l[32]||(l[32]=n("span",{class:"summary-label"},"相似度:",-1)),n("span",{class:d(["summary-value",(a=be.value.similarity,a>=90?"high":a>=70?"medium":a>=50?"low":"very-low")])},u(be.value.similarity.toFixed(1))+"% ",3)]),n("div",R,[l[33]||(l[33]=n("span",{class:"summary-label"},"差异行数:",-1)),n("span",D,u(be.value.diffLines),1)]),n("div",J,[l[34]||(l[34]=n("span",{class:"summary-label"},"新增行数:",-1)),n("span",O,u(be.value.addedLines),1)]),n("div",Q,[l[35]||(l[35]=n("span",{class:"summary-label"},"删除行数:",-1)),n("span",S,u(be.value.removedLines),1)])]),n("div",X,[n("div",Y,[l[36]||(l[36]=n("h4",null,"差异详情",-1)),n("div",Z,[n("button",{class:d(["view-btn",{active:"unified"===ye.value}]),onClick:l[14]||(l[14]=e=>ye.value="unified")}," 统一视图 ",2),n("button",{class:d(["view-btn",{active:"split"===ye.value}]),onClick:l[15]||(l[15]=e=>ye.value="split")}," 并排视图 ",2)]),l[37]||(l[37]=n("div",{class:"diff-legend"},[n("span",{class:"legend-item added"},"+ 新增"),n("span",{class:"legend-item removed"},"- 删除"),n("span",{class:"legend-item modified"},"~ 修改")],-1))]),"unified"===ye.value?(s(),t("div",ee,[(s(!0),t(p,null,h(be.value.diffs,(e,l)=>(s(),t("div",{key:l,class:d(["diff-line",e.type])},[n("span",le,u(e.lineNumber),1),n("span",ae,u(e.prefix),1),n("span",{class:"line-content",innerHTML:_e(e.content,e.type)},null,8,te)],2))),128))])):i("",!0),"split"===ye.value?(s(),t("div",se,[l[38]||(l[38]=n("div",{class:"split-header"},[n("div",{class:"split-title"},"文本A"),n("div",{class:"split-title"},"文本B")],-1)),n("div",ne,[(s(!0),t(p,null,h(je.value,(e,l)=>(s(),t("div",{key:l,class:"diff-pair"},[n("div",{class:d(["diff-side left",e.left?.type||"empty"])},[n("span",ie,u(e.left?.lineNumber||""),1),e.left?(s(),t("span",{key:0,class:"line-content",innerHTML:_e(e.left.content,e.left.type)},null,8,oe)):(s(),t("span",re))],2),n("div",{class:d(["diff-side right",e.right?.type||"empty"])},[n("span",ue,u(e.right?.lineNumber||""),1),e.right?(s(),t("span",{key:0,class:"line-content",innerHTML:_e(e.right.content,e.right.type)},null,8,ce)):(s(),t("span",ve))],2)]))),128))])])):i("",!0)])])])):i("",!0)]),xe.value?(s(),t("div",{key:0,class:d(["message-toast",ke.value])},u(xe.value),3)):i("",!0)]);var a}}}),[["__scopeId","data-v-9c34ab3f"]]);export{de as default};
