import{d as e,r as a,c as l,u as t,a as s,o as i,b as n,e as o,f as c,n as r,w as u,g as d,i as v,v as p,y as h,t as g,_ as f}from"./main-DsoSj-vY.js";const y={class:"jwt-generator"},w={class:"converter-header"},m={class:"converter-content"},b={class:"mode-section"},k={class:"mode-selector"},x={key:0,class:"generate-section"},S={class:"config-section"},T={class:"config-grid"},C={class:"config-item"},J={class:"config-item"},M={class:"config-section"},j={class:"config-grid"},N={class:"config-item"},O={class:"config-item"},H={class:"config-item"},V={class:"config-item"},A={class:"config-item"},U={class:"config-item"},W={class:"custom-payload"},D={class:"config-section"},B={class:"secret-input-wrapper"},R=["type"],_={key:0,width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},I={key:1,width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},z={class:"generate-actions"},$=["disabled"],E={key:0,class:"result-section"},L={class:"jwt-result"},P={class:"jwt-parts"},G={class:"jwt-part header-part"},K={class:"part-content"},q={class:"jwt-part payload-part"},F={class:"part-content"},Q={class:"jwt-part signature-part"},X={class:"part-content"},Y={class:"jwt-full"},Z={class:"jwt-output"},ee=["value"],ae={key:1,class:"decode-section"},le={class:"input-section"},te={class:"jwt-input-wrapper"},se={key:0,class:"decode-result-section"},ie={class:"decode-result-card"},ne={class:"card-header"},oe={class:"json-content"},ce={class:"decode-result-card"},re={class:"card-header"},ue={class:"json-content"},de={class:"token-info"},ve={class:"info-grid"},pe={class:"info-item"},he={class:"info-value"},ge={class:"info-item"},fe={class:"info-value"},ye={class:"info-item"},we={class:"info-value"},me={class:"info-item"},be={class:"info-value"},ke={class:"info-item"},xe={class:"info-value"},Se={class:"info-item"},Te={class:"info-item"},Ce={class:"info-value"},Je={class:"info-item"},Me={class:"info-value"},je={key:1,class:"error-section"},Ne={class:"error-message"},Oe=f(e({__name:"JwtGenerator",emits:["back"],setup(e){const f=a("generate"),Oe=a({alg:"HS256",typ:"JWT"}),He=a({iss:"",sub:"",aud:"",exp:null,nbf:null,iat:null}),Ve=a(""),Ae=a(""),Ue=a(!1),We=a(""),De=a(""),Be=a(""),Re=a(""),_e=a(""),Ie=a(null),ze=a(""),$e=a(""),Ee=a("success"),Le=l(()=>{if(!We.value)return{header:"",payload:"",signature:""};const e=We.value.split(".");return{header:e[0]||"",payload:e[1]||"",signature:e[2]||""}}),Pe=l(()=>!!Ie.value?.payload?.exp&&Date.now()/1e3>Ie.value.payload.exp),Ge=e=>btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,""),Ke=e=>(e+="=".repeat((4-e.length%4)%4),atob(e.replace(/-/g,"+").replace(/_/g,"/"))),qe=e=>{f.value=e,We.value="",Ie.value=null,ze.value=""},Fe=()=>{const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let a="";for(let l=0;l<32;l++)a+=e.charAt(Math.floor(62*Math.random()));Ae.value=a,la("已生成随机密钥","success")},Qe=async()=>{try{const a={...He.value};if(De.value&&(a.exp=Math.floor(new Date(De.value).getTime()/1e3)),Be.value&&(a.nbf=Math.floor(new Date(Be.value).getTime()/1e3)),Re.value&&(a.iat=Math.floor(new Date(Re.value).getTime()/1e3)),Ve.value.trim())try{const e=JSON.parse(Ve.value);Object.assign(a,e)}catch(e){return void la("自定义载荷 JSON 格式错误","error")}Object.keys(a).forEach(e=>{""!==a[e]&&null!==a[e]||delete a[e]});const l=Ge(JSON.stringify(Oe.value)),t=`${l}.${Ge(JSON.stringify(a))}`,s=await(async(e,a)=>{const l=new TextEncoder,t=l.encode(a),s=l.encode(e),i=await crypto.subtle.importKey("raw",t,{name:"HMAC",hash:"SHA-256"},!1,["sign"]),n=await crypto.subtle.sign("HMAC",i,s),o=new Uint8Array(n),c=String.fromCharCode(...o);return Ge(c)})(t,Ae.value);We.value=`${t}.${s}`,la("JWT 生成成功","success")}catch(e){la("JWT 生成失败: "+e.message,"error")}},Xe=()=>{if(!_e.value.trim())return Ie.value=null,void(ze.value="");try{const e=_e.value.trim().split(".");if(3!==e.length)throw new Error("JWT 格式错误，应该包含三个部分");const a=JSON.parse(Ke(e[0]||"")),l=JSON.parse(Ke(e[1]||""));Ie.value={header:a,payload:l,signature:e[2]},ze.value=""}catch(e){Ie.value=null,ze.value="解析失败: "+e.message}},Ye=e=>e?new Date(1e3*e).toLocaleString("zh-CN"):"N/A",Ze=async()=>{await ea(We.value)},ea=async e=>{try{await navigator.clipboard.writeText(e),la("已复制到剪贴板","success")}catch(a){la("复制失败","error")}},aa=()=>{_e.value="",Ie.value=null,ze.value=""},la=(e,a="success")=>{$e.value=e,Ee.value=a,setTimeout(()=>{$e.value=""},3e3)};t([De,Be,Re],()=>{De.value&&(He.value.exp=Math.floor(new Date(De.value).getTime()/1e3)),Be.value&&(He.value.nbf=Math.floor(new Date(Be.value).getTime()/1e3)),Re.value&&(He.value.iat=Math.floor(new Date(Re.value).getTime()/1e3))});return(()=>{const e=new Date,a=new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString().slice(0,16);Re.value=a;const l=new Date(e.getTime()+36e5-6e4*e.getTimezoneOffset());De.value=l.toISOString().slice(0,16)})(),(e,a)=>(i(),s("div",y,[n("div",w,[n("button",{class:"back-btn",onClick:a[0]||(a[0]=a=>e.$emit("back"))},[...a[17]||(a[17]=[n("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[n("path",{d:"m15 18-6-6 6-6"})],-1),c(" 返回 ",-1)])]),a[18]||(a[18]=n("h2",{class:"converter-title"},"JWT 生成器",-1))]),n("div",m,[n("div",b,[n("div",k,[n("button",{class:r(["mode-btn",{active:"generate"===f.value}]),onClick:a[1]||(a[1]=e=>qe("generate"))}," 生成 JWT ",2),n("button",{class:r(["mode-btn",{active:"decode"===f.value}]),onClick:a[2]||(a[2]=e=>qe("decode"))}," 解析 JWT ",2)])]),"generate"===f.value?(i(),s("div",x,[n("div",S,[a[22]||(a[22]=n("h3",{class:"section-title"},"Header 配置",-1)),n("div",T,[n("div",C,[a[20]||(a[20]=n("label",null,"算法 (alg)",-1)),u(n("select",{"onUpdate:modelValue":a[3]||(a[3]=e=>Oe.value.alg=e),class:"config-select"},[...a[19]||(a[19]=[v('<option value="HS256" data-v-1fc02cc5>HS256</option><option value="HS384" data-v-1fc02cc5>HS384</option><option value="HS512" data-v-1fc02cc5>HS512</option><option value="RS256" data-v-1fc02cc5>RS256</option><option value="RS384" data-v-1fc02cc5>RS384</option><option value="RS512" data-v-1fc02cc5>RS512</option>',6)])],512),[[d,Oe.value.alg]])]),n("div",J,[a[21]||(a[21]=n("label",null,"类型 (typ)",-1)),u(n("input",{"onUpdate:modelValue":a[4]||(a[4]=e=>Oe.value.typ=e),class:"config-input",placeholder:"JWT"},null,512),[[p,Oe.value.typ]])])])]),n("div",M,[a[30]||(a[30]=n("h3",{class:"section-title"},"Payload 配置",-1)),n("div",j,[n("div",N,[a[23]||(a[23]=n("label",null,"发行者 (iss)",-1)),u(n("input",{"onUpdate:modelValue":a[5]||(a[5]=e=>He.value.iss=e),class:"config-input",placeholder:"签发者"},null,512),[[p,He.value.iss]])]),n("div",O,[a[24]||(a[24]=n("label",null,"主题 (sub)",-1)),u(n("input",{"onUpdate:modelValue":a[6]||(a[6]=e=>He.value.sub=e),class:"config-input",placeholder:"主题"},null,512),[[p,He.value.sub]])]),n("div",H,[a[25]||(a[25]=n("label",null,"受众 (aud)",-1)),u(n("input",{"onUpdate:modelValue":a[7]||(a[7]=e=>He.value.aud=e),class:"config-input",placeholder:"受众"},null,512),[[p,He.value.aud]])]),n("div",V,[a[26]||(a[26]=n("label",null,"过期时间 (exp)",-1)),u(n("input",{"onUpdate:modelValue":a[8]||(a[8]=e=>De.value=e),type:"datetime-local",class:"config-input"},null,512),[[p,De.value]])]),n("div",A,[a[27]||(a[27]=n("label",null,"生效时间 (nbf)",-1)),u(n("input",{"onUpdate:modelValue":a[9]||(a[9]=e=>Be.value=e),type:"datetime-local",class:"config-input"},null,512),[[p,Be.value]])]),n("div",U,[a[28]||(a[28]=n("label",null,"签发时间 (iat)",-1)),u(n("input",{"onUpdate:modelValue":a[10]||(a[10]=e=>Re.value=e),type:"datetime-local",class:"config-input"},null,512),[[p,Re.value]])])]),n("div",W,[a[29]||(a[29]=n("label",null,"自定义载荷 (JSON格式)",-1)),u(n("textarea",{"onUpdate:modelValue":a[11]||(a[11]=e=>Ve.value=e),class:"payload-textarea",placeholder:'{"userId": 123, "role": "admin", "permissions": ["read", "write"]}',rows:"6"},"                        ",512),[[p,Ve.value]])])]),n("div",D,[a[34]||(a[34]=n("h3",{class:"section-title"},"密钥配置",-1)),n("div",B,[u(n("input",{"onUpdate:modelValue":a[12]||(a[12]=e=>Ae.value=e),type:Ue.value?"text":"password",class:"secret-input",placeholder:"请输入密钥"},null,8,R),[[h,Ae.value]]),n("button",{class:"toggle-secret-btn",onClick:a[13]||(a[13]=e=>Ue.value=!Ue.value),title:"显示/隐藏密钥"},[Ue.value?(i(),s("svg",_,[...a[31]||(a[31]=[n("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"},null,-1),n("line",{x1:"1",y1:"1",x2:"23",y2:"23"},null,-1)])])):(i(),s("svg",I,[...a[32]||(a[32]=[n("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"},null,-1),n("circle",{cx:"12",cy:"12",r:"3"},null,-1)])]))]),n("button",{class:"generate-secret-btn",onClick:Fe,title:"生成随机密钥"},[...a[33]||(a[33]=[v('<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-1fc02cc5><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8" data-v-1fc02cc5></path><path d="M21 3v5h-5" data-v-1fc02cc5></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16" data-v-1fc02cc5></path><path d="M8 16H3v5" data-v-1fc02cc5></path></svg>',1)])])])]),n("div",z,[n("button",{class:"generate-btn",onClick:Qe,disabled:!Ae.value},[...a[35]||(a[35]=[n("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[n("path",{d:"M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"})],-1),c(" 生成 JWT Token ",-1)])],8,$)]),We.value?(i(),s("div",E,[a[43]||(a[43]=n("h3",{class:"section-title"},"生成结果",-1)),n("div",L,[n("div",P,[n("div",G,[a[36]||(a[36]=n("div",{class:"part-label"},"Header",-1)),n("div",K,g(Le.value.header),1)]),a[39]||(a[39]=n("div",{class:"jwt-separator"},".",-1)),n("div",q,[a[37]||(a[37]=n("div",{class:"part-label"},"Payload",-1)),n("div",F,g(Le.value.payload),1)]),a[40]||(a[40]=n("div",{class:"jwt-separator"},".",-1)),n("div",Q,[a[38]||(a[38]=n("div",{class:"part-label"},"Signature",-1)),n("div",X,g(Le.value.signature),1)])]),n("div",Y,[a[42]||(a[42]=n("label",null,"完整 JWT Token",-1)),n("div",Z,[n("textarea",{value:We.value,readonly:"",class:"jwt-textarea"},null,8,ee),n("button",{class:"copy-btn",onClick:Ze,title:"复制"},[...a[41]||(a[41]=[n("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[n("rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2"}),n("path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"})],-1)])])])])])])):o("",!0)])):o("",!0),"decode"===f.value?(i(),s("div",ae,[n("div",le,[a[45]||(a[45]=n("h3",{class:"section-title"},"JWT Token 输入",-1)),n("div",te,[u(n("textarea",{"onUpdate:modelValue":a[14]||(a[14]=e=>_e.value=e),class:"jwt-input",placeholder:"请粘贴 JWT Token...",rows:"4",onInput:Xe},"                        ",544),[[p,_e.value]]),_e.value?(i(),s("button",{key:0,class:"clear-btn",onClick:aa,title:"清空"},[...a[44]||(a[44]=[n("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[n("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),n("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])])):o("",!0)])]),Ie.value?(i(),s("div",se,[a[59]||(a[59]=n("h3",{class:"section-title"},"解析结果",-1)),n("div",ie,[n("div",ne,[a[47]||(a[47]=n("span",{class:"card-title"},"Header",-1)),n("button",{class:"copy-btn",onClick:a[15]||(a[15]=e=>ea(JSON.stringify(Ie.value.header,null,2))),title:"复制"},[...a[46]||(a[46]=[n("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[n("rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2"}),n("path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"})],-1)])])]),n("pre",oe,g(JSON.stringify(Ie.value.header,null,2)),1)]),n("div",ce,[n("div",re,[a[49]||(a[49]=n("span",{class:"card-title"},"Payload",-1)),n("button",{class:"copy-btn",onClick:a[16]||(a[16]=e=>ea(JSON.stringify(Ie.value.payload,null,2))),title:"复制"},[...a[48]||(a[48]=[n("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[n("rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2"}),n("path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"})],-1)])])]),n("pre",ue,g(JSON.stringify(Ie.value.payload,null,2)),1)]),n("div",de,[a[58]||(a[58]=n("h4",null,"Token 信息",-1)),n("div",ve,[n("div",pe,[a[50]||(a[50]=n("span",{class:"info-label"},"算法:",-1)),n("span",he,g(Ie.value.header.alg||"N/A"),1)]),n("div",ge,[a[51]||(a[51]=n("span",{class:"info-label"},"类型:",-1)),n("span",fe,g(Ie.value.header.typ||"N/A"),1)]),n("div",ye,[a[52]||(a[52]=n("span",{class:"info-label"},"发行者:",-1)),n("span",we,g(Ie.value.payload.iss||"N/A"),1)]),n("div",me,[a[53]||(a[53]=n("span",{class:"info-label"},"主题:",-1)),n("span",be,g(Ie.value.payload.sub||"N/A"),1)]),n("div",ke,[a[54]||(a[54]=n("span",{class:"info-label"},"受众:",-1)),n("span",xe,g(Ie.value.payload.aud||"N/A"),1)]),n("div",Se,[a[55]||(a[55]=n("span",{class:"info-label"},"过期时间:",-1)),n("span",{class:r(["info-value",{expired:Pe.value}])},g(Ye(Ie.value.payload.exp)),3)]),n("div",Te,[a[56]||(a[56]=n("span",{class:"info-label"},"生效时间:",-1)),n("span",Ce,g(Ye(Ie.value.payload.nbf)),1)]),n("div",Je,[a[57]||(a[57]=n("span",{class:"info-label"},"签发时间:",-1)),n("span",Me,g(Ye(Ie.value.payload.iat)),1)])])])])):o("",!0),ze.value?(i(),s("div",je,[n("div",Ne,[a[60]||(a[60]=n("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[n("circle",{cx:"12",cy:"12",r:"10"}),n("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),n("line",{x1:"9",y1:"9",x2:"15",y2:"15"})],-1)),c(" "+g(ze.value),1)])])):o("",!0)])):o("",!0)]),$e.value?(i(),s("div",{key:0,class:r(["message",Ee.value])},g($e.value),3)):o("",!0)]))}}),[["__scopeId","data-v-1fc02cc5"]]);export{Oe as default};
